<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Echo Spark</title>
    <link rel="stylesheet" href="style.css" />

    <!-- ================= CHAT POPUP CSS ================= -->
    <style>
      /* BUTTON FLOATING */
      /* BUTTON FLOATING */
      #chat-launcher {
        position: fixed;
        bottom: 22px;
        right: 22px;
        background: #0084ff;
        color: white;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-size: 28px;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
        z-index: 9999;
        transition: 0.2s ease;
      }

      #chat-launcher:hover {
        transform: scale(1.08);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.35);
      }

      /* POPUP */
      #chat-popup {
        position: fixed;
        bottom: 95px;
        right: 20px;
        width: 360px;
        height: 480px;
        background: #ffffff;
        border-radius: 18px;
        display: none;
        flex-direction: column;
        overflow: hidden;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        z-index: 9999;
        animation: fadeIn 0.25s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* HEADER */
      #chat-header {
        background: #0084ff;
        color: white;
        padding: 12px 16px;
        font-size: 17px;
        font-weight: bold;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      #chat-header #chat-close {
        cursor: pointer;
        font-size: 20px;
        opacity: 0.85;
        transition: 0.2s;
      }

      #chat-header #chat-close:hover {
        opacity: 1;
        transform: scale(1.15);
      }

      /* MESSAGES AREA */
      #chat-messages {
        flex: 1;
        padding: 12px;
        overflow-y: auto;
        background: #f0f2f5;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      /* CHAT ROW (flex) */
      .chat-row {
        display: flex;
        align-items: flex-end;
        gap: 8px;
        max-width: 85%;
      }

      /* AI = b√™n tr√°i */
      .chat-row.ai {
        flex-direction: row;
        align-self: flex-start;
      }

      /* USER = b√™n ph·∫£i */
      .chat-row.user {
        flex-direction: row-reverse;
        align-self: flex-end;
      }

      /* AVATAR */
      .avatar {
        width: 34px;
        height: 34px;
        border-radius: 50%;
        object-fit: cover;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
      }

      /* BUBBLE */
      .bubble {
        padding: 10px 14px;
        border-radius: 18px;
        font-size: 14px;
        line-height: 1.3;
        max-width: 240px;
      }

      /* AI bubble */
      .msg-ai {
        background: #ffffff;
        color: #111;
        border-radius: 18px 18px 18px 4px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      }

      /* User bubble */
      .msg-user {
        background: #0084ff;
        color: white;
        border-radius: 18px 18px 4px 18px;
      }

      /* INPUT AREA */
      #chat-input-area {
        padding: 10px;
        background: #ffffff;
        border-top: 1px solid #ddd;
      }

      #chat-input {
        width: 100%;
        padding: 10px 14px;
        border-radius: 20px;
        border: 1px solid #ccc;
        outline: none;
        transition: 0.2s;
        font-size: 14px;
      }

      #chat-input:focus {
        border-color: #0084ff;
        box-shadow: 0 0 0 2px rgba(0, 132, 255, 0.2);
      }

      /* Typing animation */
      .typing::after {
        content: "";
        display: inline-block;
        width: 7px;
        height: 7px;
        margin-left: 6px;
        border-radius: 50%;
        background: gray;
        animation: blink 1s infinite;
      }

      @keyframes blink {
        0% {
          opacity: 0.2;
        }
        50% {
          opacity: 1;
        }
        100% {
          opacity: 0.2;
        }
      }
    </style>
  </head>

  <body>
    <!-- ================= WEBSITE CONTENT ================= -->

    <!-- HEADER -->
    <header class="navbar">
      <div class="container nav-content">
        <div class="logo">
          <img src="./IMG/logo.png" alt="Echo Spark" />
        </div>

        <!-- KH·ªêI G·ªòP MENU + BUTTON -->
        <div class="nav-right">
          <nav>
            <ul class="nav-links">
              <li><a href="#">Trang ch·ªß</a></li>
              <li><a href="#">D·ªãch v·ª•</a></li>
              <li><a href="#">Gi·ªõi thi·ªáu</a></li>
              <li><a href="#">Li√™n h·ªá</a></li>
            </ul>
          </nav>

          <div class="nav-btn">
            <button class="btn-primary">ƒêƒÉng nh·∫≠p</button>
            <button class="btn-primary">ƒêƒÉng k√Ω</button>
          </div>
        </div>
      </div>
    </header>

    <!-- HERO -->
    <section class="hero">
      <div class="container">
        <h1>Kh∆°i ngu·ªìn ti·ªÅm nƒÉng,<br />V∆∞·ª£t m·ªçi gi·ªõi h·∫°n</h1>
        <p>H·ªó tr·ª£ m·ªçi tr·∫ª em v∆∞∆°n t·ªõi cu·ªôc s·ªëng t·ªët ƒë·∫πp h∆°n.</p>
        <button class="btn-primary">ƒêƒÉng k√Ω ƒë·ªÉ t√¨m hi·ªÉu th√™m</button>

        <img src="./IMG/banner.jpg" class="hero-img" alt="Hero Image" />
      </div>
    </section>

    <!-- SECTION 1 -->
    <section class="section">
      <div class="container">
        <h2>Kh√≥a h·ªçc</h2>

        <div class="grid-3">
          <div class="card">
            <img src="./IMG/img_1.jpg" alt="" />
            <h3>G√≥i ph·ª• huynh chuy√™n s√¢u</h3>
            <p>
              D√†nh cho gia ƒë√¨nh c√≥ con t·ª± k·ªâ, tr·∫ª r·ªëi lo·∫°n ph√°t tri·ªÉn, tr·∫ª tƒÉng
              ƒë·ªông gi·∫£m ch√∫ √Ω, ho·∫∑c g·∫∑p kh√≥ khƒÉn t√¢m l√Ω.
            </p>
          </div>

          <div class="card">
            <img src="./IMG/img_2.png" alt="" />
            <h3>G√≥i d·ªãch v·ª• ƒë·ªìng h√†nh v·ªõi chuy√™n gia</h3>
            <p>
              H·ªó tr·ª£ c√° nh√¢n ho√° s√¢u - d√†nh cho tr·∫ª c·∫ßn can thi·ªáp chuy√™n m√¥n &
              ph·ª• huynh c·∫ßn h∆∞·ªõng d·∫´n c·ª• th·ªÉ.
            </p>
          </div>

          <div class="card">
            <img src="./IMG/img_3.jpg" alt="" />
            <h3>G√≥i h·ªçc li·ªáu s·ªë v√† qu·∫£n l√Ω & c√¥ng ngh·ªá</h3>
            <p>
              Gi·∫£i ph√°p tr·ªçn g√≥i d√†nh cho Trung t√¢m Gi√°o d·ª•c ƒê·∫∑c bi·ªát & Tr∆∞·ªùng
              h√≤a nh·∫≠p
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- SECTION 2 -->
    <section class="section">
      <div class="container">
        <h2>Trung t√¢m li√™n k·∫øt</h2>

        <div class="grid-2">
          <div>
            <h3>H·ªá th·ªëng C∆° s·ªü Gi√°o d·ª•c ƒê·∫∑c bi·ªát Ph√∫ Thu·ª∑</h3>
            <p>
              C∆° s·ªü 1: S·ªë nh√† 21, L√¥ 24A, Khu ƒë√¥ th·ªã Geleximco, T√¢y M·ªó, TP H√†
              N·ªôi.
            </p>
            <h3>H·ªá th·ªëng C∆° s·ªü Gi√°o d·ª•c ƒê·∫∑c bi·ªát Ph√∫ Thu·ª∑</h3>
            <p>
              C∆° s·ªü 2: S·ªë nh√† 65, ƒë∆∞·ªùng L√™ Th√°nh T√¥ng, ph∆∞·ªùng T√¢n Th·ªãnh, TP H√≤a
              B√¨nh
            </p>
            <h3>H·ªá th·ªëng C∆° s·ªü Gi√°o d·ª•c ƒê·∫∑c bi·ªát Ph√∫ Thu·ª∑</h3>
            <p>Khu An Khang, th·ªã tr·∫•n M√£n ƒê·ª©c, huy·ªán T√¢n L·∫°c, t·ªânh H√≤a B√¨nh</p>
            <button class="btn-secondary">K·∫øt n·ªëi</button>
          </div>

          <div>
            <img src="./IMG/img_4.jpg" class="round" alt="test" />
          </div>
        </div>
      </div>
    </section>

    <!-- SECTION 3 -->
    <section class="section">
      <div class="container">
        <h2>Gi·ªõi thi·ªáu</h2>
        <p>
          N·ªÅn t·∫£ng gi√°o d·ª•c - tr·ªã li·ªáu ·ª©ng d·ª•ng c√¥ng ngh·ªá ti√™n phong d√†nh cho
          tr·∫ª c√≥ nhu c·∫ßu ƒë·∫∑c bi·ªát.
        </p>
        <p>
          Echo Spark ƒë∆∞·ª£c x√¢y d·ª±ng ƒë·ªÉ ƒë·ªìng h√†nh c√πng tr·∫ª t·ª± k·ªâ, tr·∫ª r·ªëi lo·∫°n
          ph√°t tri·ªÉn, tr·∫ª tƒÉng ƒë·ªông gi·∫£m ch√∫ √Ω trong h√†nh tr√¨nh h·ªçc t·∫≠p v√† ph√°t
          tri·ªÉn.
        </p>
        <p>
          V·ªõi c√¥ng ngh·ªá h·ªó tr·ª£ ti√™n ti·∫øn bao g·ªìm AI c√° nh√¢n h√≥a, Voice Command
          v√† h·ªçc li·ªáu ƒëa gi√°c quan, Echo Spark x√¢y d·ª±ng m·ªôt m√¥i tr∆∞·ªùng h·ªçc t·∫≠p
          n∆°i tr·∫ª c√≥ th·ªÉ h·ªçc t·∫≠p ƒë·ªôc l·∫≠p, ph√°t tri·ªÉn an to√†n v√† t·ª± tin. B√™n c·∫°nh
          ƒë√≥, mang ƒë·∫øn cho ph·ª• huynh, gi√°o vi√™n m·ªôt c√¥ng c·ª• hi·ªáu qu·∫£ ƒë·ªÉ ƒë·ªìng
          h√†nh c√πng con.
        </p>
        <p>
          ƒê√¢y kh√¥ng ch·ªâ l√† m·ªôt n·ªÅn t·∫£ng EdTech m√† l√† gi·∫£i ph√°p x√≥a b·ªè kho·∫£ng
          c√°ch gi√°o d·ª•c v√† kho·∫£ng c√°ch s·ªë cho tr·∫ª c√≥ nhu c·∫ßu ƒë·∫∑c bi·ªát, ph√π h·ª£p
          ƒë·ªãnh h∆∞·ªõng h√≤a nh·∫≠p hi·ªán nay c·ªßa gi√°o d·ª•c Vi·ªát Nam.
        </p>
        <p>
          Ch√∫ng t√¥i tin r·∫±ng:
          <b>
            ‚ÄúM·ªói ƒë·ª©a tr·∫ª ƒë·ªÅu c√≥ √¢m s·∫Øc ri√™ng. Echo Spark gi√∫p thanh √¢m ·∫•y ƒë∆∞·ª£c
            l·∫Øng nghe v√† t·ªèa s√°ng.‚Äù
          </b>
        </p>
      </div>
    </section>

    <!-- TESTIMONIAL -->
    <section class="section">
      <div class="container">
        <h2>Ph·∫£n h·ªìi</h2>

        <div class="testimonial-wrapper">
          <div class="testimonial">
            <p>
              ‚Äúƒêi·ªÅu em th√≠ch nh·∫•t ·ªü Echo Spark l√† con ch·ªãu ng·ªìi h·ªçc l√¢u h∆°n.
              Tr∆∞·ªõc ƒë√¢y ch·ªâ ƒë∆∞·ª£c 3‚Äì5 ph√∫t l√† con b·ªè ch·∫°y, nh∆∞ng gi·ªù nh·ªù b√†i h·ªçc
              ng·∫Øn, nhi·ªÅu h√¨nh ·∫£nh, con ki√™n tr√¨ ƒë·∫øn 10‚Äì12 ph√∫t. Kh√¥ng nhi·ªÅu
              nh∆∞ng v·ªõi con em, ƒë√≥ l√† c·∫£ m·ªôt b∆∞·ªõc ti·∫øn r·ªìi. Em c≈©ng hi·ªÉu con h∆°n
              v√¨ h·ªá th·ªëng c√≥ b√°o c√°o m·ªói tu·∫ßn. Th·∫≠t s·ª± nh·∫π l√≤ng.‚Äù
            </p>
          </div>

          <div class="testimonial">
            <p>
              ‚ÄúT√¥i th√≠ch ph·∫ßn theo d√µi ti·∫øn tr√¨nh, nh√¨n r√µ ƒë∆∞·ª£c con h·ªçc g√¨, l√†m
              t·ªët ph·∫ßn n√†o, c√≤n kh√≥ khƒÉn g√¨. ƒêi tr·ªã li·ªáu ·ªü trung t√¢m th√¨ em √≠t
              khi n·∫Øm ƒë∆∞·ª£c chi ti·∫øt th·∫ø n√†y. Nh·ªù v·∫≠y em n√≥i chuy·ªán v·ªõi gi√°o vi√™n
              c≈©ng d·ªÖ d√†ng v√† ch·ªß ƒë·ªông h∆°n. "
            </p>
          </div>

          <div class="testimonial">
            <p>
              ‚ÄúCon t√¥i 6 tu·ªïi, n√≥i √≠t, giao ti·∫øp k√©m. T√¥i h·ªçc theo b√†i h∆∞·ªõng d·∫´n
              trong web r·ªìi th·ª±c h√†nh c√πng con m·ªói t·ªëi. B·∫•t ng·ªù l√† con b·∫Øt ƒë·∫ßu
              ch·ªß ƒë·ªông ch·ªâ ƒë·ªì v·∫≠t v√† g·ªçi t√™n nhi·ªÅu h∆°n, t∆∞∆°ng t√°c v·ªõi m·∫π nhi·ªÅu
              h∆°n. T√¥i bi·∫øt con c√≤n c·∫£ h√†nh tr√¨nh d√†i, nh∆∞ng gi·ªù t√¥i c≈©ng c·∫£m
              th·∫•y t·ª± tin h∆°n‚Äù
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- FOOTER -->
    <footer class="footer">
      <div class="container">
        <h2>EchoSpark</h2>

        <div class="footer-grid">
          <div>
            <h4>V·ªÅ Ch√∫ng T√¥i</h4>
            <p>Gi·ªõi thi·ªáu c√¥ng ty</p>
            <p>L·ªãch s·ª≠ ph√°t tri·ªÉn</p>
            <p>T·∫ßm nh√¨n v√† s·ª© m·ªánh</p>
            <p>ƒê·ªôi ng≈© nh√¢n s·ª±</p>
          </div>
          <div>
            <h4>S·∫£n Ph·∫©m & D·ªãch V·ª•</h4>
            <p>Kh√≥a h·ªçc cho t√¢m l√Ω</p>
            <p>Kh√≥a h·ªçc cho tr·∫ª em khuy·∫øt t·∫≠t</p>
            <p>T∆∞ v·∫•n t√¢m l√Ω</p>
            <p>ƒê√†o t·∫°o v√† ph√°t tri·ªÉn</p>
            <p>H·ªó tr·ª£ kh√°ch h√†ng</p>
          </div>
          <div>
            <h4>Li√™n K·∫øt Nhanh</h4>
            <p>Blog v√† tin t·ª©c</p>
            <p>Trung t√¢m tr·ª£ gi√∫p</p>
            <p>Ch√≠nh s√°ch b·∫£o m·∫≠t</p>
            <p>ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</p>
          </div>
          <div>
            <h4>Li√™n H·ªá</h4>
            <p>üìû +84 28 1234 5678</p>
            <p>üìß contact@echospark.vn</p>
            <p>üìç TP. H·ªì Ch√≠ Minh</p>
            <p>üïê Th·ª© 2 - Th·ª© 6: 8h - 18h</p>
          </div>
        </div>
      </div>
    </footer>

    <!-- ================= CHATBOX POPUP ================= -->

    <!-- N√∫t m·ªü chat -->
    <div id="chat-launcher">üí¨</div>

    <!-- POPUP CHAT -->
    <div id="chat-popup">
      <div id="chat-header">
        Chat AI
        <span id="chat-close">‚úñ</span>
      </div>

      <!-- KHUNG TIN NH·∫ÆN -->
      <div id="chat-messages">
        <!-- Tin nh·∫Øn m·∫´u AI -->
        <div class="chat-row ai">
          <!-- <img src="./IMG/ai.png" class="avatar" /> -->
          <!-- <div class="bubble msg-ai">Xin ch√†o! T√¥i c√≥ th·ªÉ gi√∫p g√¨ cho b·∫°n?</div> -->
        </div>

        <!-- Tin nh·∫Øn m·∫´u User -->
        <div class="chat-row user">
          <!-- <div class="bubble msg-user">T√¥i ƒëang th·ª≠ chat!</div> -->
          <!-- <img src="./IMG/user.png" class="avatar" /> -->
        </div>
      </div>

      <!-- KHUNG NH·∫¨P -->
      <div id="chat-input-area">
        <input id="chat-input" placeholder="Nh·∫≠p tin nh·∫Øn..." />
      </div>
    </div>

    <!-- ================= CHATBOX SCRIPT ================= -->

    <script type="module">
      import OpenAI from "https://cdn.jsdelivr.net/npm/openai@4.70.2/+esm";
      import { courseData } from "./course_data.js";

      const openai = new OpenAI({
        apiKey: "sk-8gYxx0b6etPUI6Wuymg8e9gYBEu2OdlIM676oKvSJSYxl6N5", // key free
        baseURL: "https://gpt1.shupremium.com/v1",
        dangerouslyAllowBrowser: true,
      });

      const launcher = document.getElementById("chat-launcher");
      const popup = document.getElementById("chat-popup");
      const closeBtn = document.getElementById("chat-close");
      const messages = document.getElementById("chat-messages");
      const input = document.getElementById("chat-input");

      launcher.onclick = () => (popup.style.display = "flex");
      closeBtn.onclick = () => (popup.style.display = "none");

      input.addEventListener("keydown", async (e) => {
        if (e.key === "Enter") {
          const msg = input.value.trim();
          if (!msg) return;

          appendMsg("user", msg);
          input.value = "";

          const typing = showTyping();

          try {
            const completion = await openai.chat.completions.create({
              model: "gpt-4o-mini",
              messages: [
                {
                  role: "system",
                  content: `
B·∫°n l√† tr·ª£ l√Ω chuy√™n gia t√¢m l√Ω h·ªçc.

D∆∞·ªõi ƒë√¢y l√† to√†n b·ªô d·ªØ li·ªáu kh√≥a h·ªçc:

${JSON.stringify(courseData)}

Khi tr·∫£ l·ªùi, b·∫°n PH·∫¢I tr√¨nh b√†y theo d·∫°ng bullet:

- √ù 1...
- √ù 2...
- √ù 3...

Nh·ªØng bullet n√†y ch·ªâ d√πng ƒë·ªÉ t√°ch n·ªôi dung. Ng∆∞·ªùi d√πng kh√¥ng c·∫ßn th·∫•y k√Ω hi·ªáu bullet.
N·∫øu c√¢u h·ªèi n·∫±m v∆∞·ª£t ngo√†i ph·∫°m vi chuy√™n ng√†nh t√¢m l√Ω th√¨ tr·∫£ l·ªùi: C√¢u h·ªèi n√†y n·∫±m ngo√†i ph·∫°m vi c·ªßa t√¥i!
`,
                },
                { role: "user", content: msg },
              ],
            });

            removeTyping(typing);

            const fullText = completion.choices[0].message.content;

            // T√ÅCH & HI·ªÇN TH·ªä NHI·ªÄU TIN
            sendMultiMessages(fullText);
          } catch (err) {
            removeTyping(typing);
            appendMsg("ai", "L·ªói API: " + err.message);
          }
        }
      });

      // ============================================
      // T√ÅCH BULLET & LO·∫†I B·ªé BULLET KHI HI·ªÇN TH·ªä
      // ============================================
      function sendMultiMessages(text) {
        // T√°ch bullet: -, ‚Ä¢, *, 1.
        const parts = text
          .split(/(?:^|\n)\s*(?:[-‚Ä¢*]|\d+\.)\s+/g)
          .map((p) => p.trim())
          .filter((p) => p.length > 0);

        // X√≥a bullet v√† gh√©p l·∫°i th√†nh 1 bubble
        const merged = parts
          .map((p) => p.replace(/^([-‚Ä¢*]|\d+\.)\s*/, "").trim())
          .join("<br>");

        appendMsg("ai", merged);
      }

      // ====================
      // HI·ªÇN TH·ªä TIN
      // ====================
      function appendMsg(role, text) {
        const messages = document.getElementById("chat-messages");

        if (role === "user") {
          messages.innerHTML += `
        <div class="chat-row user">
          <img src="./IMG/user.jpg" class="avatar"/>
          <div class="bubble msg-user">${text}</div>        
        </div>
      `;
        } else {
          messages.innerHTML += `
        <div class="chat-row ai">
          <img src="./IMG/ai.png" class="avatar" />
          <div class="bubble msg-ai">${text}</div>
        </div>
      `;
        }

        messages.scrollTop = messages.scrollHeight;
      }

      // ====================
      // TYPING
      // ====================
      function showTyping() {
        const div = document.createElement("div");
        div.className = "chat-row ai";
        div.innerHTML = `
      <img src="./IMG/ai.png" class="avatar" />
      <div class="bubble msg-ai typing">ƒêang tr·∫£ l·ªùi...</div>
    `;
        messages.appendChild(div);
        messages.scrollTop = messages.scrollHeight;
        return div;
      }

      function removeTyping(div) {
        if (div) div.remove();
      }
    </script>
  </body>
</html>
